<form [formGroup]="attributeForm" (ngSubmit)="onSubmit()">
    <div class="header">
        <h2 mat-dialog-title>添加属性</h2>
        <button mat-icon-button type="button" [mat-dialog-close]="false">
            <mat-icon>close</mat-icon>
        </button>
    </div>

    <div mat-dialog-content class="content">
        <!-- name -->
        <mat-form-field>
            <mat-label>名称</mat-label>
            <input matInput formControlName="name">
        </mat-form-field>

        <!-- attributeGroup -->
        <mat-form-field floatLabel="always">
            <mat-label>分组</mat-label>
            <mat-select placeholder="未分组" formControlName="attributeGroupId">
                <mat-option [value]="null">未分组</mat-option>
            </mat-select>
        </mat-form-field>

        <!-- attributeType -->
        <mat-form-field>
            <mat-label>类型</mat-label>
            <mat-select formControlName="attributeType">
                @for (typeKey of attributeTypeKeys;track $index) {
                    <mat-option [value]="typeKey"> {{ AttributeType[typeKey] }}</mat-option>
                }
            </mat-select>
        </mat-form-field>

        <!-- attributeDisplayMode -->
        @if (attributeType.value === AttributeType.SELECT) {
            <mat-form-field>
                <mat-label>显示样式</mat-label>
                <mat-select formControlName="attributeDisplayMode">
                    @for (modeKey of attributeDisplayModeKeys;track $index) {
                        <mat-option [value]="modeKey">{{ AttributeDisplayMode[modeKey] }}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
        }

        <!-- isVisible -->
        @if (attributeType.value !== AttributeType.HIDDEN) {
            <mat-form-field>
                <mat-label>是否作为产品选项显示</mat-label>
                <mat-select formControlName="isVisible">
                    <mat-option [value]="true">是</mat-option>
                    <mat-option [value]="false">否</mat-option>
                </mat-select>
            </mat-form-field>
        }

        <!-- canBuyerSelect -->
        <!-- @if (attributeType.value === AttributeType.BOOLEAN) {
             <mat-form-field>
                 <mat-label>卖家是否可选择属性值</mat-label>
                 <mat-select formControlName="canBuyerSelect">
                     <mat-option [value]="true">是</mat-option>
                     <mat-option [value]="false">否</mat-option>
                 </mat-select>
             </mat-form-field>
         }-->

        <!-- isDefaultValue -->
        <!--@if (attributeType.value === AttributeType.BOOLEAN) {
            <mat-form-field>
                <mat-label>默认值</mat-label>
                <mat-select formControlName="isDefault">
                    <mat-option [value]="true">是</mat-option>
                    <mat-option [value]="false">否</mat-option>
                </mat-select>
            </mat-form-field>
        }-->

        <!-- editable -->
        <!-- @if (attributeType.value === AttributeType.TEXTAREA) {
             <mat-form-field>
                 <mat-label>默认值</mat-label>
                 <mat-select formControlName="editable">
                     <mat-option [value]="true">是</mat-option>
                     <mat-option [value]="false">否</mat-option>
                 </mat-select>
             </mat-form-field>
         }-->

        <!-- attributeOptions -->
        @if (attributeType.value === AttributeType.SELECT || attributeType.value === AttributeType.HIDDEN) {
            <div cdkDropList (cdkDropListDropped)="onDropped($event)">
                <mat-label>属性选项</mat-label>
                <div class="attribute-option-group-container" formArrayName="attributeOptions">
                    @for (item of attributeOptions.controls;track index;let index = $index) {
                        <div cdkDrag [formGroupName]="index" class="attribute-option-content">
                            <mat-icon class="drag-box" fontIcon="drag_indicator"></mat-icon>
                            <input matNativeControl type="text" formControlName="name">
                            @if (index !== 0) {
                                <mat-icon fontSet="material-icons-outlined">delete</mat-icon>
                            }
                            @if (index + 1 === attributeOptions.length) {
                                <mat-icon (click)="addNewAttributeOption()" fontSet="material-icons-outlined">add_box
                                </mat-icon>
                            }
                        </div>
                    }
                </div>
            </div>
        }

    </div>

    <div mat-dialog-actions align="start">
        <button mat-raised-button type="button" [mat-dialog-close]="false">取消</button>
        <button mat-raised-button type="submit" color="primary" [mat-dialog-close]="true">保存</button>
        <!--@if (attributeId) {
            <button mat-raised-button type="submit" color="primary" [mat-dialog-close]="true">保存</button>
        } @else {
            <button mat-raised-button type="button" (click)="createAttribute()" color="primary">下一步</button>
        }-->
    </div>
</form>
